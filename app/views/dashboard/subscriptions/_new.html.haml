-# .subscription
-#   %p Monthly Subscription
-# = form_tag dashboard_subscriptions_path do
-#   %script.stripe-button{data: {amount: '499',
-#       currency: 'EUR',
-#       description: 'Monthly subscription',
-#       name: "#{current_user.username}",
-#       email: "#{current_user.email}",
-#       key: "#{Rails.configuration.stripe[:publishable_key]}",
-#       locale: 'auto'},
-#     src: "https://checkout.stripe.com/checkout.js"}
%script{src: 'https://js.stripe.com/v3/'}

.subscription
  %p Monthly Subscription
  %button.btn.btn-lg.btn-primary{data: {toggle: 'modal', target: '#subscriptionModal'}, type: 'button'} Subscribe

.modal.fade#subscriptionModal{tabindex: '-1', role: 'dialog', aria: {labelledby: 'subscriptionModalLabel'}}
  .modal-dialog{role: 'document'}
    .modal-content
      .modal-header
        %h5.modal-title 4,99â‚¬ Monthly Subscription
        %button.close{type: 'button', data: {dismiss: 'modal'}, aria: {label: 'close'}}
          %span{aria: {hidden: 'true'}} &times;
      .modal-body
        .container
          .row
            .col
              = simple_form_for :user, url: dashboard_subscriptions_path, html: {id: 'subscription-form'} do |f|
                .row
                  .col
                    = f.input :first_name, label: false, placeholder: 'First Name'
                  .col
                    = f.input :last_name, label: false, placeholder: 'Last Name'
                .row
                  .col
                    = f.input :email, label: false, placeholder: 'Email', input_html: {value: current_user.email}
                .row
                  .col
                    #card-number-container
                      #card-number
                      %span.brand
                        %i#brand-icon.fa.fa-credit-card
                    #card-number-error{role: 'alert'}
                .row
                  .col
                    #card-expiry
                    #card-expiry-error{role: 'alert'}
                  .col
                    #card-cvc
                    #card-cvc-error{role: 'alert'}
      .modal-footer
        %button.btn.btn-secondary{data: {dismiss: 'modal'}, type: 'button'} Close
        %button#submit-btn.btn.btn-primary Submit


- content_for :after_js do
  :javascript
    initStripe("#{Rails.configuration.stripe[:publishable_key]}");
