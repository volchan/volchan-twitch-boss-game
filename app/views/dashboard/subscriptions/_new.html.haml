-# .subscription
-#   %p Monthly Subscription
-# = form_tag dashboard_subscriptions_path do
-#   %script.stripe-button{data: {amount: '499',
-#       currency: 'EUR',
-#       description: 'Monthly subscription',
-#       name: "#{current_user.username}",
-#       email: "#{current_user.email}",
-#       key: "#{Rails.configuration.stripe[:publishable_key]}",
-#       locale: 'auto'},
-#     src: "https://checkout.stripe.com/checkout.js"}
%script{src: 'https://js.stripe.com/v3/'}

.subscription
  %p Monthly Subscription
  %button.btn.btn-lg.btn-primary{data: {toggle: 'modal', target: '#subscriptionModal'}, type: 'button'} Subscribe

.modal.fade#subscriptionModal{tabindex: '-1', role: 'dialog', aria: {labelledby: 'subscriptionModalLabel'}}
  .modal-dialog{role: 'document'}
    .modal-content
      .modal-body
        .sub-form
          .sub-form-header
            %h5 Monthly Subscription
            %button.close{type: 'button', data: {dismiss: 'modal'}, aria: {label: 'close'}}
              %span{aria: {hidden: 'true'}} &times;
          = simple_form_for :user, url: dashboard_subscriptions_path, html: {id: 'subscription-form'} do |f|
            .sub-form-user-infos
              .sub-form-user-infos-top
                = f.input :first_name, label: false, placeholder: 'First Name'
                = f.input :last_name, label: false, placeholder: 'Last Name'
              .sub-form-user-infos-middle
                = f.input :email, label: false, placeholder: 'Email', input_html: {value: current_user.email}
              .sub-form-user-infos-bottom
                .sub-form-user-infos-bottom-top
                  = f.input :address, label: false, placeholder: 'Address'
                  = f.input :city, label: false, placeholder: 'City'
                .sub-form-user-infos-bottom-bottom
                  = f.input :postal_code, label: false, placeholder: 'Postal Code'
                  = f.input :country, label: false, priority: form_priority_country, priority_divider: "~~~~~~"
            .sub-form-card-infos
              .sub-form-card-infos-top
                #card-input
                  .brand
                    %i#brand-icon.fa.fa-credit-card
                  #card-number
              #card-number-error{role: 'alert'}
              .sub-form-card-infos-bottom
                .sub-form-card-infos-bottom-left
                  .expiry-container
                    #card-expiry.form-control
                    #card-expiry-error{role: 'alert'}
                .sub-form-card-infos-bottom-right
                  .cvc-container
                    #card-cvc.form-control
                    #card-cvc-error{role: 'alert'}
            .sub-form-submit
              %button{type: 'submit', class: 'btn btn-block btn-primary', id: 'stripe-submit'}
                %i.fa.fa-lock{aria: {hidden: 'true'}}
                Finish and Subscribe

- content_for :after_js do
  :javascript
    initStripe("#{Rails.configuration.stripe[:publishable_key]}");
